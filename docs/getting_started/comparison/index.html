<!doctype html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width">
<meta name="generator" content="Docusaurus v2.0.0-alpha.56">
<title data-react-helmet="true">Comparison | PopGen.jl</title><meta data-react-helmet="true" name="twitter:card" content="summary_large_image"><meta data-react-helmet="true" property="og:title" content="Comparison | PopGen.jl"><meta data-react-helmet="true" name="description" content="There&#x27;s a reason we started investing so many hours and so many new grey hairs into writing PopGen.jl when there was an existing ecosystem in R to perform these same tasks. Like we explain in the home page of these docs, we want a platform that is:"><meta data-react-helmet="true" property="og:description" content="There&#x27;s a reason we started investing so many hours and so many new grey hairs into writing PopGen.jl when there was an existing ecosystem in R to perform these same tasks. Like we explain in the home page of these docs, we want a platform that is:"><meta data-react-helmet="true" property="og:url" content="https://pdimens.github.io/PopGen.jl/docs/getting_started/comparison"><link data-react-helmet="true" rel="shortcut icon" href="/PopGen.jl/img/favicon.ico"><link data-react-helmet="true" rel="canonical" href="https://pdimens.github.io/PopGen.jl/docs/getting_started/comparison"><link rel="stylesheet" href="/PopGen.jl/styles.a580ca78.css">
<link rel="preload" href="/PopGen.jl/styles.817db340.js" as="script">
<link rel="preload" href="/PopGen.jl/runtime~main.bfd1b950.js" as="script">
<link rel="preload" href="/PopGen.jl/main.b7f5bc75.js" as="script">
<link rel="preload" href="/PopGen.jl/1.150e29f1.js" as="script">
<link rel="preload" href="/PopGen.jl/2.453ea7bd.js" as="script">
<link rel="preload" href="/PopGen.jl/3.04ba6188.js" as="script">
<link rel="preload" href="/PopGen.jl/1be78505.4f167d68.js" as="script">
<link rel="preload" href="/PopGen.jl/49.aaf97b73.js" as="script">
<link rel="preload" href="/PopGen.jl/72e583ac.406e1240.js" as="script">
<link rel="preload" href="/PopGen.jl/99164b56.051b744f.js" as="script">
</head>
<body>
<script>!function(){function t(t){document.documentElement.setAttribute("data-theme",t)}var e=window.matchMedia("(prefers-color-scheme: dark)"),n=function(){var t=null;try{t=localStorage.getItem("theme")}catch(t){}return t}();null!==n?t(n):e.matches&&t("dark")}()</script><div id="__docusaurus">
<nav class="navbar navbar--light navbar--fixed-top"><div class="navbar__inner"><div class="navbar__items"><div aria-label="Navigation bar toggle" class="navbar__toggle" role="button" tabindex="0"><svg xmlns="http://www.w3.org/2000/svg" width="30" height="30" viewBox="0 0 30 30" role="img" focusable="false"><title>Menu</title><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></div><a class="navbar__brand" href="/PopGen.jl/"><img class="navbar__logo" src="/PopGen.jl/img/logo_icon.png" alt="PopGen.jl logo"><strong class="navbar__title">PopGen.jl</strong></a></div><div class="navbar__items navbar__items--right"><a aria-current="page" class="navbar__item navbar__link navbar__link--active" href="/PopGen.jl/docs/">Docs</a><a class="navbar__item navbar__link" href="/PopGen.jl/docs/getting_started/about">About</a><a class="navbar__item navbar__link" href="/PopGen.jl/blog">Blog</a><a class="navbar__item navbar__link" href="/PopGen.jl/docs/getting_started/community">Get Involved</a><a href="https://github.com/pdimens/popgen.jl" target="_blank" rel="noopener noreferrer" class="navbar__item navbar__link">GitHub</a><div class="react-toggle react-toggle--disabled displayOnlyInLargeViewport_1gtM"><div class="react-toggle-track"><div class="react-toggle-track-check"><span class="toggle_keGJ moon_1gwN"></span></div><div class="react-toggle-track-x"><span class="toggle_keGJ sun_3CPA"></span></div></div><div class="react-toggle-thumb"></div><input type="checkbox" disabled="" aria-label="Dark mode toggle" class="react-toggle-screenreader-only"></div></div></div><div role="presentation" class="navbar-sidebar__backdrop"></div><div class="navbar-sidebar"><div class="navbar-sidebar__brand"><a class="navbar__brand" href="/PopGen.jl/"><img class="navbar__logo" src="/PopGen.jl/img/logo_icon.png" alt="PopGen.jl logo"><strong class="navbar__title">PopGen.jl</strong></a></div><div class="navbar-sidebar__items"><div class="menu"><ul class="menu__list"><li class="menu__list-item"><a aria-current="page" class="menu__link navbar__link--active" href="/PopGen.jl/docs/">Docs</a></li><li class="menu__list-item"><a class="menu__link" href="/PopGen.jl/docs/getting_started/about">About</a></li><li class="menu__list-item"><a class="menu__link" href="/PopGen.jl/blog">Blog</a></li><li class="menu__list-item"><a class="menu__link" href="/PopGen.jl/docs/getting_started/community">Get Involved</a></li><li class="menu__list-item"><a href="https://github.com/pdimens/popgen.jl" target="_blank" rel="noopener noreferrer" class="menu__link">GitHub</a></li></ul></div></div></div></nav><div class="main-wrapper"><div class="docPage_1kjD"><div class="docSidebarContainer_1cYp"><div class="sidebar_1kLs"><div class="menu menu--responsive menu_w2sC"><button aria-label="Open Menu" aria-haspopup="true" class="button button--secondary button--sm menu__button" type="button"><svg aria-label="Menu" class="sidebarMenuIcon_2vk4" xmlns="http://www.w3.org/2000/svg" height="24" width="24" viewBox="0 0 32 32" role="img" focusable="false"><title>Menu</title><path stroke="currentColor" stroke-linecap="round" stroke-miterlimit="10" stroke-width="2" d="M4 7h22M4 15h22M4 23h22"></path></svg></button><ul class="menu__list"><li class="menu__list-item"><a class="menu__link menu__link--sublist menu__link--active" href="#!">Getting Started</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/PopGen.jl/docs/getting_started/install">Installation</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/PopGen.jl/docs/getting_started/julia_primer">A quick Julia primer</a></li><li class="menu__list-item"><a aria-current="page" class="menu__link menu__link--active active" tabindex="0" href="/PopGen.jl/docs/getting_started/comparison">Comparison</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/PopGen.jl/docs/getting_started/types">PopObj and PopData types</a></li><li class="menu__list-item"><a class="menu__link" tabindex="0" href="/PopGen.jl/docs/getting_started/other_types">Other data types</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Importing Data</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/PopGen.jl/docs/io/file_import">Reading in data</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/PopGen.jl/docs/io/delimited">Delimited format</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/PopGen.jl/docs/io/genepop">Genepop format</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/PopGen.jl/docs/io/vcf">Variant Call Format</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/PopGen.jl/docs/io/datasets">Provided datasets</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Tutorial</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/PopGen.jl/docs/tutorials/manipulate">Start here</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/PopGen.jl/docs/tutorials/accessing">Accessing elements</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/PopGen.jl/docs/tutorials/exclusion">Data Exclusion</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/PopGen.jl/docs/tutorials/populations">Location and population data</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/PopGen.jl/docs/tutorials/viewsort">Viewing and sorting</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">Analyses</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/PopGen.jl/docs/analyses/hardyweinberg">Hardy-Weinberg Equilibrium</a></li><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/PopGen.jl/docs/analyses/relatedness">Relatedness (Kinship)</a></li></ul></li><li class="menu__list-item menu__list-item--collapsed"><a class="menu__link menu__link--sublist" href="#!">API</a><ul class="menu__list"><li class="menu__list-item"><a class="menu__link" tabindex="-1" href="/PopGen.jl/docs/api/api">API</a></li></ul></li></ul></div></div></div><main class="docMainContainer_FFX1"><div class="container padding-vert--lg docItemWrapper_1cc7"><div class="row"><div class="col docItemCol_2GOA"><div class="docItemContainer_2cwg"><article><header><h1 class="docTitle_1vWb">Comparison</h1></header><div class="markdown"><p>There&#x27;s a reason we started investing so many hours and so many new grey hairs into writing PopGen.jl when there was an existing ecosystem in R to perform these same tasks. Like we explain in the home page of these docs, we want a platform that is:</p><ol><li>fast(er)</li><li>written in a single language</li><li>easy to use</li></ol><p>So, we&#x27;d like to prove that Julia and PopGen.jl actually achieves that by showing a few benchmarks comparing PopGen.jl to <code>adegenet</code> and <code>pegas</code>, which along with <code>ape</code> are arguably the most commonly used and robust population genetic packages available. It&#x27;s worth mentioning that we ourselves use and have published work incorporating these packages, and are tremendously grateful for the work invested in those packages. We appreciate those folks and have tremendous respect and envy for the work they continue to do! Here are links to <a href="https://github.com/thibautjombart/adegenet" target="_blank" rel="noopener noreferrer">adegenet</a>, <a href="https://academic.oup.com/bioinformatics/article/26/3/419/215731/" target="_blank" rel="noopener noreferrer">pegas</a>, and <a href="https://cran.r-project.org/package=ape" target="_blank" rel="noopener noreferrer">ape</a>.  </p><h2><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_ZqCz" id="benchmarks"></a>Benchmarks<a aria-hidden="true" tabindex="-1" class="hash-link" href="#benchmarks" title="Direct link to heading">#</a></h2><p>To make this a practical comparison, we&#x27;re going to use the <code>gulfsharks</code> data because it is considerably larger (212 samples x 2213 loci) than <code>nancycats</code> (237 x 9) and a bit more of a &quot;stress test&quot;.  All benchmarks in R are performed using the <code>microbenchmark</code> package, and  <code>BenchmarkTools</code> are used for Julia. </p><div><ul role="tablist" aria-orientation="horizontal" class="tabs"><li role="tab" tabindex="0" aria-selected="true" class="tabs__item tabItem_3zTA tabs__item--active">load Julia packages</li><li role="tab" tabindex="0" aria-selected="false" class="tabs__item tabItem_3zTA">load R packages</li></ul><div role="tabpanel" class="margin-vert--md"><div><div class="mdxCodeBlock_iHAB"><div class="codeBlockContent_32p_"><button type="button" aria-label="Copy code to clipboard" class="copyButton_1BYj">Copy</button><div tabindex="0" class="prism-code language-julia codeBlock_19pQ"><div class="codeBlockLines_2n9r" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">using BenchmarkTools, PopGen</span></div></div></div></div></div></div></div></div><p>As a note, the reported benchmarks are being performed on a 64-bit Manjaro Linux system on a nothing-special Lenovo Thinkbook 14S  with 8gigs of RAM and a 8th gen Intel i5 mobile processor. <strong>Note:</strong> all of the Julia benchmarks, unless explicitly stated, are performed single-threaded (i.e. not parallel, distributed, or GPU). </p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_ZqCz" id="loading-in-data"></a>Loading in data<a aria-hidden="true" tabindex="-1" class="hash-link" href="#loading-in-data" title="Direct link to heading">#</a></h3><p>Since <code>gulfsharks</code> is shamelessly provided in PopGen.jl, we will just load it with <code>genepop()</code>.  If you would like to try this yourself in R, find the <code>gulfsharks.gen</code> file in the package repository under <code>/data/source/gulfsharks.gen</code>. Since the file importer now uses CSV.jl to read files, there is one step of the genepop parser that is multithreaded. However, the majority of the data parsing (formatting the raw data into a correct PopData structure) occurs using a single thread. This R benchmark will take a few minutes. Consider making some tea while you wait.</p><div><ul role="tablist" aria-orientation="horizontal" class="tabs"><li role="tab" tabindex="0" aria-selected="true" class="tabs__item tabItem_3zTA tabs__item--active">Julia</li><li role="tab" tabindex="0" aria-selected="false" class="tabs__item tabItem_3zTA">R</li></ul><div role="tabpanel" class="margin-vert--md"><div><div class="mdxCodeBlock_iHAB"><div class="codeBlockContent_32p_"><button type="button" aria-label="Copy code to clipboard" class="copyButton_1BYj">Copy</button><div tabindex="0" class="prism-code language-undefined codeBlock_19pQ"><div class="codeBlockLines_2n9r" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">@benchmark sharks = genepop(&quot;data/source/gulfsharks.gen&quot;, silent = true)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">BenchmarkTools.Trial: </span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  memory estimate:  330.58 MiB</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  allocs estimate:  6905285</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  --------------</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  minimum time:     806.202 ms (5.91% GC)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  median time:      884.887 ms (5.61% GC)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  mean time:        910.722 ms (5.41% GC)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  maximum time:     1.071 s (4.82% GC)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  --------------</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  samples:          6</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  evals/sample:     1</span></div></div></div></div></div></div></div></div><p><img src="/PopGen.jl/img/speedplot.png" alt="import plot"></p><p>Comparing averages, PopGen.jl clocks in at <code>910ms</code> versus adegenet&#x27;s <code>6.745s</code> , so ~7.4x faster.</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_ZqCz" id="popdata-vs-genind-size"></a><code>PopData</code> vs <code>genind</code> size<a aria-hidden="true" tabindex="-1" class="hash-link" href="#popdata-vs-genind-size" title="Direct link to heading">#</a></h3><p>It was pretty tricky to come up with a sensible/efficient/convenient data structure for PopGen.jl, and the original attempt was a Julian variant to a <code>genind</code>, which itself is something known as an <code>S4 class object</code>. While the two-DataFrames design might not seem like it took a lot of effort, we ultimately decided that the column-major style and available tools, combined with careful genotype Typing was a decent &quot;middle-ground&quot; of ease-of-use vs performance. Plus, we are suckers for consistent syntax, which <code>genind</code>&#x27;s don&#x27;t have compared to standard R syntax (looking at you too, Tidyverse/ggplot!). </p><p><em>Anyway</em>, it&#x27;s important to understand how much space your data will take up in memory (your RAM) when you load it in, especially since data&#x27;s only getting bigger! Keep in mind that <code>gulfsharks</code> in PopGen.jl also provides lat/long data, which <em>should</em> inflate the size of the object somewhat compared to the <code>genind</code>, which we won&#x27;t add any location data to.</p><div><ul role="tablist" aria-orientation="horizontal" class="tabs"><li role="tab" tabindex="0" aria-selected="true" class="tabs__item tabItem_3zTA tabs__item--active">Julia</li><li role="tab" tabindex="0" aria-selected="false" class="tabs__item tabItem_3zTA">R</li></ul><div role="tabpanel" class="margin-vert--md"><div><div class="mdxCodeBlock_iHAB"><div class="codeBlockContent_32p_"><button type="button" aria-label="Copy code to clipboard" class="copyButton_1BYj">Copy</button><div tabindex="0" class="prism-code language-julia codeBlock_19pQ"><div class="codeBlockLines_2n9r" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">julia&gt; Base.summarysize(sharks)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">3527765</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">#bytes</span></div></div></div></div></div></div></div></div><p><img src="/PopGen.jl/img/objectplot.png" alt="data structure plot"></p><p>The original file is <code>3.2mb</code>, and our <code>PopData</code> object takes up ~<code>3.5mb</code> in memory (300kb larger than the source file) versus the ~<code>5.3mb</code> of a <code>genind</code>, which is ~1.5x larger than the source file. That&#x27;s quite a big difference!</p><h3><a aria-hidden="true" tabindex="-1" class="anchor enhancedAnchor_ZqCz" id="chi-squared-test-for-hwe"></a>Chi-squared test for HWE<a aria-hidden="true" tabindex="-1" class="hash-link" href="#chi-squared-test-for-hwe" title="Direct link to heading">#</a></h3><p>This is a classic population genetics test and a relatively simple one. The R benchmark will take a while again, so if you&#x27;re following along, this would be a good time to reconnect with an old friend.</p><div><ul role="tablist" aria-orientation="horizontal" class="tabs"><li role="tab" tabindex="0" aria-selected="true" class="tabs__item tabItem_3zTA tabs__item--active">Julia</li><li role="tab" tabindex="0" aria-selected="false" class="tabs__item tabItem_3zTA">R</li></ul><div role="tabpanel" class="margin-vert--md"><div><div class="mdxCodeBlock_iHAB"><div class="codeBlockContent_32p_"><button type="button" aria-label="Copy code to clipboard" class="copyButton_1BYj">Copy</button><div tabindex="0" class="prism-code language-julia codeBlock_19pQ"><div class="codeBlockLines_2n9r" style="color:#bfc7d5;background-color:#292d3e"><div class="token-line" style="color:#bfc7d5"><span class="token plain">julia&gt; @benchmark hwe_test(sharks)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">BenchmarkTools.Trial: </span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  memory estimate:  46.22 MiB</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  allocs estimate:  1050525</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  --------------</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  minimum time:     145.476 ms (0.00% GC)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  median time:      179.146 ms (4.35% GC)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  mean time:        176.142 ms (3.56% GC)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  maximum time:     204.813 ms (0.00% GC)</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  --------------</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  samples:          29</span></div><div class="token-line" style="color:#bfc7d5"><span class="token plain">  evals/sample:     1</span></div></div></div></div></div></div></div></div><p><img src="/PopGen.jl/img/chisqplot.png" alt="chi squared plot"></p><p>Comparing averages, PopGen.jl clocks in at ~<code>176ms</code> versus adegenet&#x27;s <code>6.3s</code>, so ~<strong>35.8x</strong> faster(!) </p></div></article><div class="margin-vert--xl"><div class="row"><div class="col"><a href="https://github.com/pdimens/popgen.jl/edit/documentation/docs/getting_started/comparison.md" target="_blank" rel="noreferrer noopener"><svg fill="currentColor" height="1.2em" width="1.2em" preserveAspectRatio="xMidYMid meet" viewBox="0 0 40 40" style="margin-right:0.3em;vertical-align:sub"><g><path d="m34.5 11.7l-3 3.1-6.3-6.3 3.1-3q0.5-0.5 1.2-0.5t1.1 0.5l3.9 3.9q0.5 0.4 0.5 1.1t-0.5 1.2z m-29.5 17.1l18.4-18.5 6.3 6.3-18.4 18.4h-6.3v-6.2z"></path></g></svg>Edit this page</a></div></div></div><div class="margin-vert--lg"><nav class="pagination-nav"><div class="pagination-nav__item"><a class="pagination-nav__link" href="/PopGen.jl/docs/getting_started/julia_primer"><div class="pagination-nav__sublabel">Previous</div><div class="pagination-nav__label">« A quick Julia primer</div></a></div><div class="pagination-nav__item pagination-nav__item--next"><a class="pagination-nav__link" href="/PopGen.jl/docs/getting_started/types"><div class="pagination-nav__sublabel">Next</div><div class="pagination-nav__label">PopObj and PopData types »</div></a></div></nav></div></div></div><div class="col col--3"><div class="tableOfContents_TbNY"><ul class="table-of-contents table-of-contents__left-border"><li><a href="#benchmarks" class="table-of-contents__link">Benchmarks</a><ul><li><a href="#loading-in-data" class="table-of-contents__link">Loading in data</a></li><li><a href="#popdata-vs-genind-size" class="table-of-contents__link"><code>PopData</code> vs <code>genind</code> size</a></li><li><a href="#chi-squared-test-for-hwe" class="table-of-contents__link">Chi-squared test for HWE</a></li></ul></li></ul></div></div></div></div></main></div></div><footer class="footer footer--dark"><div class="container"><div class="text--center"><div>Copyright © 2020 Pavel Dimens & Jason Selwyn. Built with Docusaurus. Rawr!</div></div></div></footer></div>
<script src="/PopGen.jl/styles.817db340.js"></script>
<script src="/PopGen.jl/runtime~main.bfd1b950.js"></script>
<script src="/PopGen.jl/main.b7f5bc75.js"></script>
<script src="/PopGen.jl/1.150e29f1.js"></script>
<script src="/PopGen.jl/2.453ea7bd.js"></script>
<script src="/PopGen.jl/3.04ba6188.js"></script>
<script src="/PopGen.jl/1be78505.4f167d68.js"></script>
<script src="/PopGen.jl/49.aaf97b73.js"></script>
<script src="/PopGen.jl/72e583ac.406e1240.js"></script>
<script src="/PopGen.jl/99164b56.051b744f.js"></script>
</body>
</html>